"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5296],{81788:(e,t,o)=>{o.d(t,{TZ:()=>a,u7:()=>s,B8:()=>i});var r=o(31069),n=o(68492);const a=(e,t,o)=>r.Z.put({endpoint:`api/v1/dashboard/${e}/filter_state/${o}/`,jsonPayload:{value:t}}).then((e=>e.json.message)).catch((e=>(n.Z.error(e),null))),s=(e,t)=>r.Z.post({endpoint:`api/v1/dashboard/${e}/filter_state`,jsonPayload:{value:t}}).then((e=>e.json.key)).catch((e=>(n.Z.error(e),null))),i=(e,t)=>r.Z.get({endpoint:`api/v1/dashboard/${e}/filter_state/${t}/`}).then((({json:e})=>JSON.parse(e.value))).catch((e=>(n.Z.error(e),null)))},14073:(e,t,o)=>{o.r(t),o.d(t,{MigrationContext:()=>N,default:()=>k});var r=o(67294),n=o(93185),a=o(61988),s=o(37703),i=o(5977),l=o(14114),u=o(38703),c=o(51995),d=o(74069),f=o(35932),h=o(11965);const m=(0,c.iK)(d.Z)`
  .modal-content {
    height: 900px;
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }

  .modal-header {
    flex: 0 1 auto;
  }

  .modal-body {
    flex: 1 1 auto;
    overflow: auto;
  }

  .modal-footer {
    flex: 0 1 auto;
  }

  .ant-modal-body {
    overflow: auto;
  }
`,p=({onClickReview:e,onClickSnooze:t,onHide:o,show:n,hideFooter:s=!1})=>(0,h.tZ)(m,{show:n,onHide:o,title:(0,a.t)("Ready to review filters in this dashboard?"),hideFooter:s,footer:(0,h.tZ)(r.Fragment,null,(0,h.tZ)(f.Z,{buttonSize:"small",onClick:t},(0,a.t)("Remind me in 24 hours")),(0,h.tZ)(f.Z,{buttonSize:"small",onClick:o},(0,a.t)("Cancel")),(0,h.tZ)(f.Z,{buttonSize:"small",buttonStyle:"primary",onClick:e},(0,a.t)("Start Review"))),responsive:!0},(0,h.tZ)("div",null,(0,a.t)("filter_box will be deprecated in a future version of Superset. Please replace filter_box by dashboard filter components.")));var E=o(67994),_=o(63389),v=o(50810),b=o(14505),O=o(40582),Z=o(72570),S=o(61337),R=o(69856),y=o(27600),D=o(23525),T=o(70695),w=o(52794),C=o(81788);const N=r.createContext(R.Qi.NOOP);(0,O.Z)();const x=r.lazy((()=>Promise.all([o.e(1216),o.e(876),o.e(2671),o.e(8680),o.e(193),o.e(83),o.e(452)]).then(o.bind(o,55224)))),g=document.title,k=()=>{const e=(0,s.I0)(),t=(0,s.v9)((e=>e.user)),{addDangerToast:o}=(0,l.e)(),{idOrSlug:c}=(0,i.UO)(),{result:d,error:f}=(0,E.QU)(c),{result:m,error:O}=(0,E.Es)(c),{result:k,error:I}=(0,E.JL)(c),L=(0,r.useRef)(!1),Q=f||O,$=Boolean(d&&m),F=(0,D.e)(y.KD.migrationState),P=(0,n.c)(n.T.ENABLE_FILTER_BOX_MIGRATION),{dashboard_title:z,css:j,metadata:A,id:B=0}=d||{},[M,H]=(0,r.useState)(F||R.Qi.NOOP);if((0,r.useEffect)((()=>{const o=m&&m.some((e=>{var t;return"filter_box"===(null==(t=e.form_data)?void 0:t.viz_type)}));if(d&&(0,T.M)(d,t)){if(null!=A&&A.native_filter_configuration)return void H(P?R.Qi.CONVERTED:R.Qi.NOOP);if(o)if(P){if(F&&Object.values(R.Qi).includes(F))return void H(F);const e=(0,S.rV)(S.dR.filter_box_transition_snoozed_at,{});if(Date.now()-(e[B]||0)<R.Yd)return void H(R.Qi.SNOOZED);H(R.Qi.UNDECIDED)}else(0,n.c)(n.T.DASHBOARD_NATIVE_FILTERS)&&e((0,Z.Dz)((0,a.t)("filter_box will be deprecated in a future version of Superset. Please replace filter_box by dashboard filter components.")))}}),[$]),(0,r.useEffect)((()=>{B&&async function(){const t=(0,D.e)(y.KD.nativeFiltersKey);let o=t||{};const r=(0,D.e)(y.KD.nativeFilters);t&&(o=await(0,C.B8)(B,t)),r&&(o=r),$&&(L.current||(L.current=!0,(0,n.c)(n.T.DASHBOARD_NATIVE_FILTERS_SET)&&e((0,w.pi)(B))),e((0,_.Y)(d,m,M,o)))}()}),[$,M]),(0,r.useEffect)((()=>(z&&(document.title=z),()=>{document.title=g})),[z]),(0,r.useEffect)((()=>j?(0,b.Z)(j):()=>{}),[j]),(0,r.useEffect)((()=>{I?o((0,a.t)("Error loading chart datasources. Filters may not work correctly.")):e((0,v.Fy)(k))}),[o,k,I,e]),Q)throw Q;return $?(0,h.tZ)(r.Fragment,null,(0,h.tZ)(p,{show:M===R.Qi.UNDECIDED,hideFooter:!P,onHide:()=>{H(R.Qi.SNOOZED)},onClickReview:()=>{H(R.Qi.REVIEWING)},onClickSnooze:()=>{const e=(0,S.rV)(S.dR.filter_box_transition_snoozed_at,{});(0,S.LS)(S.dR.filter_box_transition_snoozed_at,{...e,[B]:Date.now()}),H(R.Qi.SNOOZED)}}),(0,h.tZ)(N.Provider,{value:M},(0,h.tZ)(x,null))):(0,h.tZ)(u.Z,null)}},14505:(e,t,o)=>{function r(e){const t="CssEditor-css",o=document.head||document.getElementsByTagName("head")[0],r=document.querySelector(`.${t}`)||function(e){const t=document.createElement("style");return t.className="CssEditor-css",t.type="text/css",t}();return"styleSheet"in r?r.styleSheet.cssText=e:r.innerHTML=e,o.appendChild(r),function(){r.remove()}}o.d(t,{Z:()=>r})},67994:(e,t,o)=>{o.d(t,{hb:()=>h,QU:()=>m,Es:()=>p,JL:()=>E});var r,n=o(22102),a=o(67294);!function(e){e.LOADING="loading",e.COMPLETE="complete",e.ERROR="error"}(r||(r={}));const s={status:r.LOADING,result:null,error:null};function i(e,t){return(0,a.useMemo)((()=>{if(e.status!==r.COMPLETE)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:r.ERROR,result:null,error:e}}}),[e,t])}const l=e=>e.result;function u(e){return i(function(e){const[t,o]=(0,a.useState)(s),i=(0,a.useRef)((()=>{}));return(0,a.useEffect)((()=>{o(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,n.Z)({method:"GET",endpoint:e})({}).then((e=>{t||o({status:r.COMPLETE,result:e,error:null})})).catch((e=>{t||o({status:r.ERROR,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}var c=o(15926);function d({owners:e}){return e?e.map((e=>`${e.first_name} ${e.last_name}`)):null}const f=o.n(c)().encode({columns:["owners.first_name","owners.last_name"],keys:["none"]});function h(e){return i(u(`/api/v1/chart/${e}?q=${f}`),d)}const m=e=>i(u(`/api/v1/dashboard/${e}`),(e=>({...e,metadata:e.json_metadata&&JSON.parse(e.json_metadata)||{},position_data:e.position_json&&JSON.parse(e.position_json)}))),p=e=>u(`/api/v1/dashboard/${e}/charts`),E=e=>u(`/api/v1/dashboard/${e}/datasets`)}}]);