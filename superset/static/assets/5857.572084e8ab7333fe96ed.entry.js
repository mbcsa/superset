"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5857],{51127:e=>{var t=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,a){var l,o,s;return a=a||{},l=JSON.stringify([1],void 0,void 0===a.indent?2:a.indent).slice(2,-3),o=""===l?1/0:void 0===a.maxLength?80:a.maxLength,s=a.replacer,function e(a,r,n){var i,d,c,h,u,p,m,b,g,Z,f,v;if(a&&"function"==typeof a.toJSON&&(a=a.toJSON()),void 0===(f=JSON.stringify(a,s)))return f;if(m=o-r.length-n,f.length<=m&&(g=f.replace(t,(function(e,t){return t||e+" "}))).length<=m)return g;if(null!=s&&(a=JSON.parse(f),s=void 0),"object"==typeof a&&null!==a){if(b=r+l,c=[],d=0,Array.isArray(a))for(Z="[",i="]",m=a.length;d<m;d++)c.push(e(a[d],b,d===m-1?0:1)||"null");else for(Z="{",i="}",m=(p=Object.keys(a)).length;d<m;d++)h=p[d],u=JSON.stringify(h)+": ",void 0!==(v=e(a[h],b,u.length+(d===m-1?0:1)))&&c.push(u+v);if(c.length>0)return[Z,l+c.join(",\n"+b),i].join("\n"+r)}return f}(e,"",0)}},79789:(e,t,a)=>{a.d(t,{Z:()=>d});var l=a(67294),o=a(51995),s=a(61988),r=a(70163),n=a(58593),i=a(11965);const d=function({certifiedBy:e,details:t,size:a="l"}){const d=(0,o.Fg)();return(0,i.tZ)(n.u,{id:"certified-details-tooltip",title:(0,i.tZ)(l.Fragment,null,e&&(0,i.tZ)("div",null,(0,i.tZ)("strong",null,(0,s.t)("Certified by %s",e))),(0,i.tZ)("div",null,t))},(0,i.tZ)(r.Z.Certified,{iconColor:d.colors.primary.base,iconSize:a}))}},17198:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(51995),o=a(61988),s=a(67294),r=a(9875),n=a(74069),i=a(49238),d=a(11965);const c=l.iK.div`
  padding-top: 8px;
  width: 50%;
  label {
    color: ${({theme:e})=>e.colors.grayscale.base};
    text-transform: uppercase;
  }
`,h=l.iK.div`
  line-height: 40px;
  padding-top: 16px;
`;function u({description:e,onConfirm:t,onHide:a,open:l,title:u}){const[p,m]=(0,s.useState)(!0),[b,g]=(0,s.useState)(""),Z=()=>{g(""),t()};return(0,d.tZ)(n.Z,{disablePrimaryButton:p,onHide:()=>{g(""),a()},onHandledPrimaryAction:Z,primaryButtonName:(0,o.t)("delete"),primaryButtonType:"danger",show:l,title:u},(0,d.tZ)(h,null,e),(0,d.tZ)(c,null,(0,d.tZ)(i.lX,{htmlFor:"delete"},(0,o.t)('Type "%s" to confirm',(0,o.t)("DELETE"))),(0,d.tZ)(r.II,{type:"text",id:"delete",autoComplete:"off",value:b,onChange:e=>{var t;const a=null!=(t=e.target.value)?t:"";m(a.toUpperCase()!==(0,o.t)("DELETE")),g(a)},onPressEnter:()=>{p||Z()}})))}},36674:(e,t,a)=>{a.d(t,{Z:()=>h});var l=a(67294),o=a(51995),s=a(11965),r=a(61988),n=a(58593),i=a(33626),d=a(70163);const c=o.iK.a`
  ${({theme:e})=>s.iv`
    font-size: ${e.typography.sizes.xl}px;
    display: flex;
    padding: 0 0 0 ${2*e.gridUnit}px;
  `};
`,h=({itemId:e,isStarred:t,showTooltip:a,saveFaveStar:o,fetchFaveStar:h})=>{(0,i.J)((()=>{h&&h(e)}));const u=(0,l.useCallback)((a=>{a.preventDefault(),o(e,!!t)}),[t,e,o]),p=(0,s.tZ)(c,{href:"#",onClick:u,className:"fave-unfave-icon",role:"button"},t?(0,s.tZ)(d.Z.FavoriteSelected,null):(0,s.tZ)(d.Z.FavoriteUnselected,null));return a?(0,s.tZ)(n.u,{id:"fave-unfave-tooltip",title:(0,r.t)("Click to favorite/unfavorite")},p):p}},20818:(e,t,a)=>{a.d(t,{Z:()=>j});var l=a(67294),o=a(9875),s=a(49238),r=a(51127),n=a.n(r),i=a(35932),d=a(26506),c=a(15926),h=a.n(c),u=a(51995),p=a(61988),m=a(31069),b=a(55786),g=a(81545),Z=a(78161),f=a(74069),v=a(94670),y=a(45697),C=a.n(y),S=a(95470),x=a(11965);const w={onChange:C().func,labelMargin:C().number,colorScheme:C().string,hasCustomLabelColors:C().bool};class _ extends l.PureComponent{constructor(e){super(e),this.state={hovered:!1},this.categoricalSchemeRegistry=(0,g.Z)(),this.choices=this.categoricalSchemeRegistry.keys().map((e=>[e,e])),this.schemes=this.categoricalSchemeRegistry.getMap()}setHover(e){this.setState({hovered:e})}render(){const{colorScheme:e,labelMargin:t=0,hasCustomLabelColors:a}=this.props;return(0,x.tZ)(S.Z,{description:(0,p.t)("Any color palette selected here will override the colors applied to this dashboard's individual charts"),labelMargin:t,name:"color_scheme",onChange:this.props.onChange,value:e,choices:this.choices,clearable:!0,schemes:this.schemes,hovered:this.state.hovered,hasCustomLabelColors:a})}}_.propTypes=w,_.defaultProps={hasCustomLabelColors:!1,colorScheme:void 0,onChange:()=>{}};const k=_;var J=a(98286),N=a(14114),O=a(91877),T=a(93185);const X=(0,u.iK)(s.xJ)`
  margin-bottom: 0;
`,A=(0,u.iK)(v.Ad)`
  border-radius: ${({theme:e})=>e.borderRadius}px;
  border: 1px solid ${({theme:e})=>e.colors.secondary.light2};
`,j=(0,N.ZP)((({addSuccessToast:e,colorScheme:t,dashboardId:a,dashboardInfo:r,dashboardTitle:c,onHide:u=(()=>{}),onlyApply:y=!1,onSubmit:C=(()=>{}),show:S=!1})=>{const[w]=d.qz.useForm(),[_,N]=(0,l.useState)(!1),[j,F]=(0,l.useState)(!1),[E,I]=(0,l.useState)(t),[L,B]=(0,l.useState)(""),[D,M]=(0,l.useState)(),[R,$]=(0,l.useState)([]),[z,P]=(0,l.useState)([]),q=y?(0,p.t)("Apply"):(0,p.t)("Save"),H=async e=>{const{error:t,statusText:a,message:l}=await(0,J.O)(e);let o=t||a||(0,p.t)("An error has occurred");"object"==typeof l&&"json_metadata"in l?o=l.json_metadata:"string"==typeof l&&(o=l,"Forbidden"===l&&(o=(0,p.t)("You do not have permission to edit this dashboard"))),f.Z.error({title:"Error",content:o,okButtonProps:{danger:!0,className:"btn-danger"}})},K=(0,l.useCallback)(((e="owners",t="",a,l)=>{const o=h().encode({filter:t,page:a,page_size:l});return m.Z.get({endpoint:`/api/v1/dashboard/related/${e}?q=${o}`}).then((e=>({data:e.json.result.map((e=>({value:e.value,label:e.text}))),totalCount:e.json.count})))}),[]),U=(0,l.useCallback)((e=>{const{id:t,dashboard_title:a,slug:l,certified_by:o,certification_details:s,owners:r,roles:i,metadata:d,is_managed_externally:c}=e,h={id:t,title:a,slug:l||"",certifiedBy:o||"",certificationDetails:s||"",isManagedExternally:c||!1};w.setFieldsValue(h),M(h),$(r),P(i),I(d.color_scheme),null!=d&&d.positions&&delete d.positions;const u={...d};null!=u&&u.shared_label_colors&&delete u.shared_label_colors,B(u?n()(u):"")}),[w]),V=(0,l.useCallback)((()=>{N(!0),m.Z.get({endpoint:`/api/v1/dashboard/${a}`}).then((e=>{var t;const a=e.json.result,l=null!=(t=a.json_metadata)&&t.length?JSON.parse(a.json_metadata):{};U({...a,metadata:l}),N(!1)}),H)}),[a,U]),G=()=>{try{return null!=L&&L.length?JSON.parse(L):{}}catch(e){return{}}},W=e=>{const t=(0,b.Z)(e).map((e=>({id:e.value,full_name:e.label})));$(t)},Y=e=>{const t=(0,b.Z)(e).map((e=>({id:e.value,name:e.label})));P(t)},Q=()=>(R||[]).map((e=>({value:e.id,label:e.full_name||`${e.first_name} ${e.last_name}`}))),ee=(e,{updateMetadata:t=!0}={})=>{const a=(0,g.Z)().keys(),l=G();if(e&&!a.includes(e))throw f.Z.error({title:"Error",content:(0,p.t)("A valid color scheme is required"),okButtonProps:{danger:!0,className:"btn-danger"}}),new Error("A valid color scheme is required");t&&(l.color_scheme=e,l.label_colors=l.label_colors||{},B(n()(l))),I(e)};return(0,l.useEffect)((()=>{S&&(r?U(r):V()),v.Ad.preload()}),[r,V,U,S]),(0,l.useEffect)((()=>{c&&D&&D.title!==c&&w.setFieldsValue({...D,title:c})}),[D,c,w]),(0,x.tZ)(f.Z,{show:S,onHide:u,title:(0,p.t)("Dashboard properties"),footer:(0,x.tZ)(l.Fragment,null,(0,x.tZ)(i.Z,{htmlType:"button",buttonSize:"small",onClick:u,cta:!0},(0,p.t)("Cancel")),(0,x.tZ)(i.Z,{onClick:w.submit,buttonSize:"small",buttonStyle:"primary",className:"m-r-5",cta:!0,disabled:null==D?void 0:D.isManagedExternally,tooltip:null!=D&&D.isManagedExternally?(0,p.t)("This dashboard is managed externally, and can't be edited in Superset"):""},q)),responsive:!0},(0,x.tZ)(d.qz,{form:w,onFinish:()=>{var t;const{title:l,slug:o,certifiedBy:s,certificationDetails:r}=w.getFieldsValue();let i=E,d="",c=L;if(null!=(t=c)&&t.length){const e=JSON.parse(c);i=(null==e?void 0:e.color_scheme)||E,d=(null==e?void 0:e.color_namespace)||"",null!=e&&e.shared_label_colors&&delete e.shared_label_colors;const t=(0,Z.Z)().getColorMap(d,i,!0);e.shared_label_colors=t,c=n()(e)}ee(i,{updateMetadata:!1});const h={},b={};(0,O.cr)(T.T.DASHBOARD_RBAC)&&(h.roles=z,b.roles=(z||[]).map((e=>e.id)));const g={id:a,title:l,slug:o,jsonMetadata:c,owners:R,colorScheme:i,colorNamespace:d,certifiedBy:s,certificationDetails:r,...h};y?(e((0,p.t)("Dashboard properties updated")),C(g),u()):m.Z.put({endpoint:`/api/v1/dashboard/${a}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({dashboard_title:l,slug:o||null,json_metadata:c||null,owners:(R||[]).map((e=>e.id)),certified_by:s||null,certification_details:s&&r?r:null,...b})}).then((()=>{e((0,p.t)("The dashboard has been saved")),C(g),u()}),H)},layout:"vertical",initialValues:D},(0,x.tZ)(d.X2,null,(0,x.tZ)(d.JX,{xs:24,md:24},(0,x.tZ)("h3",null,(0,p.t)("Basic information")))),(0,x.tZ)(d.X2,{gutter:16},(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(s.xJ,{label:(0,p.t)("Title"),name:"title"},(0,x.tZ)(o.II,{type:"text",disabled:_}))),(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(X,{label:(0,p.t)("URL slug"),name:"slug"},(0,x.tZ)(o.II,{type:"text",disabled:_})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("A readable URL for your dashboard")))),(0,O.cr)(T.T.DASHBOARD_RBAC)?(()=>{const e=G(),t=!!Object.keys((null==e?void 0:e.label_colors)||{}).length;return(0,x.tZ)(l.Fragment,null,(0,x.tZ)(d.X2,null,(0,x.tZ)(d.JX,{xs:24,md:24},(0,x.tZ)("h3",{style:{marginTop:"1em"}},(0,p.t)("Access")))),(0,x.tZ)(d.X2,{gutter:16},(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(X,{label:(0,p.t)("Owners")},(0,x.tZ)(d.qb,{allowClear:!0,ariaLabel:(0,p.t)("Owners"),disabled:_,mode:"multiple",onChange:W,options:(e,t,a)=>K("owners",e,t,a),value:Q()})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("Owners is a list of users who can alter the dashboard. Searchable by name or username."))),(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(X,{label:(0,p.t)("Roles")},(0,x.tZ)(d.qb,{allowClear:!0,ariaLabel:(0,p.t)("Roles"),disabled:_,mode:"multiple",onChange:Y,options:(e,t,a)=>K("roles",e,t,a),value:(z||[]).map((e=>({value:e.id,label:`${e.name}`})))})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, then the dashboard is available to all roles.")))),(0,x.tZ)(d.X2,null,(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(k,{hasCustomLabelColors:t,onChange:ee,colorScheme:E,labelMargin:4}))))})():(()=>{const e=G(),t=!!Object.keys((null==e?void 0:e.label_colors)||{}).length;return(0,x.tZ)(d.X2,{gutter:16},(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)("h3",{style:{marginTop:"1em"}},(0,p.t)("Access")),(0,x.tZ)(X,{label:(0,p.t)("Owners")},(0,x.tZ)(d.qb,{allowClear:!0,ariaLabel:(0,p.t)("Owners"),disabled:_,mode:"multiple",onChange:W,options:(e,t,a)=>K("owners",e,t,a),value:Q()})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("Owners is a list of users who can alter the dashboard. Searchable by name or username."))),(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)("h3",{style:{marginTop:"1em"}},(0,p.t)("Colors")),(0,x.tZ)(k,{hasCustomLabelColors:t,onChange:ee,colorScheme:E,labelMargin:4})))})(),(0,x.tZ)(d.X2,null,(0,x.tZ)(d.JX,{xs:24,md:24},(0,x.tZ)("h3",null,(0,p.t)("Certification")))),(0,x.tZ)(d.X2,{gutter:16},(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(X,{label:(0,p.t)("Certified by"),name:"certifiedBy"},(0,x.tZ)(o.II,{type:"text",disabled:_})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("Person or group that has certified this dashboard."))),(0,x.tZ)(d.JX,{xs:24,md:12},(0,x.tZ)(X,{label:(0,p.t)("Certification details"),name:"certificationDetails"},(0,x.tZ)(o.II,{type:"text",disabled:_})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("Any additional detail to show in the certification tooltip.")))),(0,x.tZ)(d.X2,null,(0,x.tZ)(d.JX,{xs:24,md:24},(0,x.tZ)("h3",{style:{marginTop:"1em"}},(0,x.tZ)(i.Z,{buttonStyle:"link",onClick:()=>F(!j)},(0,x.tZ)("i",{className:"fa fa-angle-"+(j?"down":"right"),style:{minWidth:"1em"}}),(0,p.t)("Advanced"))),j&&(0,x.tZ)(l.Fragment,null,(0,x.tZ)(X,{label:(0,p.t)("JSON metadata")},(0,x.tZ)(A,{showLoadingForImport:!0,name:"json_metadata",value:L,onChange:B,tabSize:2,width:"100%",height:"200px",wrapEnabled:!0})),(0,x.tZ)("p",{className:"help-block"},(0,p.t)("This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.")))))))}))}}]);
//# sourceMappingURL=5857.572084e8ab7333fe96ed.entry.js.map